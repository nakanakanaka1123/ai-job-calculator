
	      <!DOCTYPE html>
<html>
  <head>
    <title>CodeSandbox</title>

    <script type="importmap">
      {"imports":{"react":"https://esm.sh/react@18.3.1","recharts":"https://esm.sh/recharts?external=react,react-dom","lucide-react":"https://esm.sh/lucide-react?external=react,react-dom","react-dom":"https://esm.sh/react-dom@18.3.1","react/jsx-runtime":"https://esm.sh/react@18.3.1/jsx-runtime","react-dom/client":"https://esm.sh/react-dom@18.3.1/client","tailwindcss/defaultTheme":"https://esm.sh/tailwindcss/defaultTheme","tailwindcss-animate":"https://esm.sh/tailwindcss-animate"}}
    </script>

    <script>
      window.addEventListener("error", function (event) {
        const errorObj = {
          message: event.message,
          source: event.filename,
          lineno: event.lineno,
          colno: event.colno,
          stack: event.error ? event.error.stack : null
        };
        window.parent.postMessage(
          { action: "error", error: JSON.stringify(errorObj) },
          "*"
        );
        event.preventDefault();
      });

  function handleImportError(error) {
    throw new Error('Import module failed: ' + error.target.src);
  }

  const observer = new MutationObserver(mutations => {
    mutations.forEach(mutation => {
      mutation.addedNodes.forEach(node => {
        if (node.tagName === 'SCRIPT' && node.type === 'module') {
          node.onerror = handleImportError;
        }
      });
    });
  });

  observer.observe(document.documentElement, { childList: true, subtree: true });

  document.querySelectorAll('script[type="module"]').forEach(script => {
    script.onerror = handleImportError;
  });

  
window.console = new Proxy(console, {
  get(target, prop) {
    if (['log', 'warn', 'error'].includes(prop)) {
      return new Proxy(target[prop], {
        apply(fn, thisArg, args) {
          fn.apply(thisArg, args);
          window.parent.postMessage({ action: 'console', 
            type: prop, 
            args: args.map((arg) => {
              try {
                return JSON.stringify(arg).replace(/^["']|["']$/g, '');
              } catch (e) {
                return arg;
              }
            }) 
          }, '*');
        }
      });
    }
    return target[prop];
  }
});


    </script>
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,container-queries"></script>
    <style type="text/tailwindcss">
      @layer base {
        :root {
          --background: 0 0% 100%;
          --foreground: 222.2 47.4% 11.2%;

          --muted: 210 40% 96.1%;
          --muted-foreground: 215.4 16.3% 46.9%;

          --popover: 0 0% 100%;
          --popover-foreground: 222.2 47.4% 11.2%;

          --border: 214.3 31.8% 91.4%;
          --input: 214.3 31.8% 91.4%;

          --card: 0 0% 100%;
          --card-foreground: 222.2 47.4% 11.2%;

          --primary: 222.2 47.4% 11.2%;
          --primary-foreground: 210 40% 98%;

          --secondary: 210 40% 96.1%;
          --secondary-foreground: 222.2 47.4% 11.2%;

          --accent: 210 40% 96.1%;
          --accent-foreground: 222.2 47.4% 11.2%;

          --destructive: 0 100% 50%;
          --destructive-foreground: 210 40% 98%;

          --ring: 215 20.2% 65.1%;

          --radius: 0.5rem;
        }

        .dark {
          --background: 224 71% 4%;
          --foreground: 213 31% 91%;

          --muted: 223 47% 11%;
          --muted-foreground: 215.4 16.3% 56.9%;

          --accent: 216 34% 17%;
          --accent-foreground: 210 40% 98%;

          --popover: 224 71% 4%;
          --popover-foreground: 215 20.2% 65.1%;

          --border: 216 34% 17%;
          --input: 216 34% 17%;

          --card: 224 71% 4%;
          --card-foreground: 213 31% 91%;

          --primary: 210 40% 98%;
          --primary-foreground: 222.2 47.4% 1.2%;

          --secondary: 222.2 47.4% 11.2%;
          --secondary-foreground: 210 40% 98%;

          --destructive: 0 63% 31%;
          --destructive-foreground: 210 40% 98%;

          --ring: 216 34% 17%;

          --radius: 0.5rem;
        }
      }
    </style>
    <script type="module">
          import defaultTheme from "tailwindcss/defaultTheme"
          import tailwindcssAnimate from "tailwindcss-animate"

          const fontFamily = defaultTheme.fontFamily;

          tailwind.config = {
            darkMode: ["class"],
        content: ["app/**/*.{ts,tsx}", "components/**/*.{ts,tsx}"],
        theme: {
          container: {
            center: true,
            padding: "2rem",
            screens: {
              "2xl": "1400px",
            },
          },
          extend: {
            colors: {
              border: "hsl(var(--border))",
              input: "hsl(var(--input))",
              ring: "hsl(var(--ring))",
              background: "hsl(var(--background))",
              foreground: "hsl(var(--foreground))",
              primary: {
                DEFAULT: "hsl(var(--primary))",
                foreground: "hsl(var(--primary-foreground))",
              },
              secondary: {
                DEFAULT: "hsl(var(--secondary))",
                foreground: "hsl(var(--secondary-foreground))",
              },
              destructive: {
                DEFAULT: "hsl(var(--destructive))",
                foreground: "hsl(var(--destructive-foreground))",
              },
              muted: {
                DEFAULT: "hsl(var(--muted))",
                foreground: "hsl(var(--muted-foreground))",
              },
              accent: {
                DEFAULT: "hsl(var(--accent))",
                foreground: "hsl(var(--accent-foreground))",
              },
              popover: {
                DEFAULT: "hsl(var(--popover))",
                foreground: "hsl(var(--popover-foreground))",
              },
              card: {
                DEFAULT: "hsl(var(--card))",
                foreground: "hsl(var(--card-foreground))",
              },
            },
            borderRadius: {
              lg: `var(--radius)`,
              md: `calc(var(--radius) - 2px)`,
              sm: "calc(var(--radius) - 4px)",
            },
            fontFamily: {
              sans: [...fontFamily.sans],
            },

            keyframes: {
              "accordion-down": {
                from: { height: "0" },
                to: { height: "var(--radix-accordion-content-height)" },
              },
              "accordion-up": {
                from: { height: "var(--radix-accordion-content-height)" },
                to: { height: "0" },
              },
            },
            animation: {
              "accordion-down": "accordion-down 0.2s ease-out",
              "accordion-up": "accordion-up 0.2s ease-out",
            },
          },
        },
        plugins: [tailwindcssAnimate]
      }
    </script>
    <!-- babeljs -->
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel" data-type="module">
      		  import {createRoot} from "react-dom/client";
            import React from "react";
      		  
import { useState, useEffect } from "react";
import { 
  BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer,
  RadarChart, PolarGrid, PolarAngleAxis, PolarRadiusAxis, Radar, Legend
} from "recharts";
import { 
  ArrowRight, RefreshCw, Brain, Briefcase, Shield, Send, Check, 
  ChevronLeft, Share2, Download, Mail, Twitter, Linkedin, Facebook, 
  Copy, Info, AlertTriangle, Award, Zap, Gift, TrendingUp
} from "lucide-react";

function AIJobRiskCalculator() {
  const [step, setStep] = useState(-1);
  const [answers, setAnswers] = useState({});
  const [result, setResult] = useState(null);
  const [email, setEmail] = useState("nakakou1023fukui@gmail.com");
  const [emailSent, setEmailSent] = useState(false);
  const [jobTitle, setJobTitle] = useState("");
  const [animateIn, setAnimateIn] = useState(true);
  const [sharedLinkCopied, setSharedLinkCopied] = useState(false);
  const [progress, setProgress] = useState(0);
  
  useEffect(() => {
    // 総質問数に対する進捗率を計算
    const totalQuestions = questions.length + 2; // +1 for job title & job field
    let currentProgress = 0;
    
    if (step > -1) {
      currentProgress = ((step + 1) / totalQuestions) * 100;
    }
    
    setProgress(currentProgress);
  }, [step]);
  
  // よりシンプルな質問にリニューアル
  const questions = [
    {
      id: "repetitive",
      question: "あなたの仕事は毎日同じことの繰り返しが多いですか？",
      description: "例：データ入力、定型レポート作成、決まった手順での作業など",
      options: [
        { value: 10, label: "ほぼすべて同じことの繰り返しです", icon: "🔄" },
        { value: 7, label: "同じ作業が多いですが、例外的な対応も時々あります", icon: "⚙️" },
        { value: 4, label: "決まった作業と臨機応変な対応が半々くらいです", icon: "🔀" },
        { value: 2, label: "ほとんどが状況に応じて異なる対応が必要です", icon: "🌊" },
        { value: 0, label: "毎回新しい課題に取り組むことがほとんどです", icon: "🆕" }
      ]
    },
    {
      id: "communication",
      question: "あなたの仕事では人との関わりやコミュニケーションがどれくらい重要ですか？",
      description: "例：営業、カウンセリング、チームリーダー、接客など",
      options: [
        { value: 0, label: "人との深い関わりが仕事の中心です", icon: "👥" },
        { value: 2, label: "人間関係を築くことが重要な部分を占めています", icon: "🤝" },
        { value: 5, label: "一般的なコミュニケーションが必要です", icon: "💬" },
        { value: 8, label: "簡単な連絡や指示のやり取り程度です", icon: "📝" },
        { value: 10, label: "ほとんど一人で黙々と作業します", icon: "🧑‍💻" }
      ]
    },
    {
      id: "judgment",
      question: "あなたの仕事ではどれくらい複雑な判断や決断が必要ですか？",
      description: "例：経営判断、診断、投資判断、重要な意思決定など",
      options: [
        { value: 0, label: "難しい判断や大きな決断を頻繁に下します", icon: "⚖️" },
        { value: 3, label: "重要な判断を行うことがよくあります", icon: "🔍" },
        { value: 5, label: "時々重要な判断が必要になります", icon: "🤔" },
        { value: 8, label: "基本的なルールに沿った簡単な判断が多いです", icon: "📋" },
        { value: 10, label: "ほとんど判断は必要なく、手順通りに進めます", icon: "📑" }
      ]
    },
    {
      id: "physical",
      question: "あなたの仕事には手先の器用さや体を使う技術がどれくらい必要ですか？",
      description: "例：外科医、職人、スポーツ選手、理学療法士など",
      options: [
        { value: 0, label: "非常に高度な身体技術が必要です（外科医、職人など）", icon: "👨‍⚕️" },
        { value: 3, label: "かなり高い身体技術が必要です", icon: "🛠️" },
        { value: 5, label: "ある程度の身体技術が必要です", icon: "🧰" },
        { value: 8, label: "基本的な動作ができれば十分です", icon: "👋" },
        { value: 10, label: "ほとんど身体技術は必要ありません", icon: "💻" }
      ]
    },
    {
      id: "dataProcessing",
      question: "あなたの仕事ではデータや情報を扱う作業がどれくらいありますか？",
      description: "例：データ入力、集計、分析、報告書作成など",
      options: [
        { value: 10, label: "ほぼすべてがデータや情報を扱う作業です", icon: "📊" },
        { value: 8, label: "多くの時間をデータ処理に費やします", icon: "📈" },
        { value: 5, label: "データ処理と他の作業が半々くらいです", icon: "⚖️" },
        { value: 2, label: "データは扱いますが、解釈や活用が中心です", icon: "🔍" },
        { value: 0, label: "ほとんどデータ処理はありません", icon: "🎨" }
      ]
    },
    {
      id: "empathy",
      question: "あなたの仕事では人の気持ちを理解したり共感することがどれくらい大切ですか？",
      description: "例：カウンセラー、看護師、教師、接客業など",
      options: [
        { value: 0, label: "人の感情理解が仕事の核心部分です", icon: "❤️" },
        { value: 2, label: "感情に寄り添うことがとても重要です", icon: "🤗" },
        { value: 5, label: "ある程度の共感能力が必要です", icon: "👂" },
        { value: 8, label: "基本的な礼儀や対応ができれば十分です", icon: "👔" },
        { value: 10, label: "ほとんど感情面での対応は必要ありません", icon: "🤖" }
      ]
    },
    {
      id: "creative",
      question: "あなたの仕事ではどれくらい創造性やアイデアが必要ですか？",
      description: "例：デザイナー、作家、研究者、広告企画など",
      options: [
        { value: 0, label: "常に新しいアイデアや創造性が求められます", icon: "💡" },
        { value: 2, label: "頻繁に創造的な発想が必要です", icon: "🎨" },
        { value: 5, label: "時々創造的な解決策を考える必要があります", icon: "🔎" },
        { value: 8, label: "決まった方法の中で少し工夫する程度です", icon: "📝" },
        { value: 10, label: "ほとんど決まったやり方で進めます", icon: "📋" }
      ]
    }
  ];
  
  const jobField = {
    id: "jobField",
    question: "あなたの職種に最も近いものを選んでください",
    options: [
      { value: "office", label: "一般事務・管理部門（総務、人事、経理など）", icon: "📊" },
      { value: "tech", label: "IT・エンジニア・技術職", icon: "💻" },
      { value: "service", label: "サービス業・接客・飲食", icon: "🍽️" },
      { value: "medical", label: "医療・介護・福祉", icon: "⚕️" },
      { value: "creative", label: "クリエイティブ・デザイン・メディア", icon: "🎨" },
      { value: "education", label: "教育・保育・研究", icon: "🎓" },
      { value: "manufacturing", label: "製造・建設・物流・運輸", icon: "🏗️" },
      { value: "finance", label: "金融・保険・不動産", icon: "💰" },
      { value: "sales", label: "営業・販売", icon: "🛒" },
      { value: "other", label: "その他", icon: "🔄" }
    ]
  };
  
  const handleSelectOption = (questionId, value) => {
    setAnimateIn(false);
    setTimeout(() => {
      setAnswers({
        ...answers,
        [questionId]: value
      });
      setAnimateIn(true);
    }, 300);
  };

  const handleNext = () => {
    setAnimateIn(false);
    setTimeout(() => {
      if (step < questions.length) {
        setStep(step + 1);
      } else {
        calculateResult();
      }
      setAnimateIn(true);
    }, 300);
  };

  const handleBack = () => {
    setAnimateIn(false);
    setTimeout(() => {
      setStep(Math.max(0, step - 1));
      setAnimateIn(true);
    }, 300);
  };

  const handleReset = () => {
    setAnimateIn(false);
    setTimeout(() => {
      setStep(-1);
      setAnswers({});
      setResult(null);
      setEmailSent(false);
      setJobTitle("");
      setAnimateIn(true);
    }, 300);
  };

  const calculateResult = () => {
    // 職種による基本リスク調整値 (0-10)
    const jobRiskBase = {
      office: 8.0,
      tech: 4.5,
      service: 5.5,
      medical: 3.5,
      creative: 2.5,
      education: 4.0,
      manufacturing: 6.5,
      finance: 7.5,
      sales: 5.0,
      other: 5.0
    };
    
    // 各項目のスコアを集計
    let totalScore = 0;
    let answeredQuestions = 0;
    
    for (const question of questions) {
      if (answers[question.id] !== undefined) {
        totalScore += answers[question.id];
        answeredQuestions++;
      }
    }
    
    // 平均スコアを計算 (0-10)
    const avgScore = answeredQuestions > 0 ? totalScore / answeredQuestions : 5;
    
    // 職種による調整を適用
    const jobBaseRisk = answers.jobField ? jobRiskBase[answers.jobField] : 5;
    
    // 最終的なAI代替確率を計算 (0-100%)
    const replacementRisk = Math.min(98, Math.max(5, Math.round((avgScore * 0.7 + jobBaseRisk * 0.3) * 10)));
    
    // 各領域の侵食リスクを算出
    const areaRisks = [
      { name: "定型作業", value: Math.min(100, answers.repetitive * 10), fullMark: 100 },
      { name: "データ処理", value: Math.min(100, answers.dataProcessing * 10), fullMark: 100 },
      { name: "判断・決断", value: Math.min(100, answers.judgment * 7.5), fullMark: 100 },
      { name: "創造性", value: Math.min(100, answers.creative * 6), fullMark: 100 },
      { name: "感情理解", value: Math.min(100, answers.empathy * 5), fullMark: 100 },
      { name: "身体技術", value: Math.min(100, answers.physical * 6), fullMark: 100 },
    ];
    
    // より詳細なアドバイスを生成
    let advice = "";
    let detailedAdvice = [];
    let strengths = [];
    let weaknesses = [];
    let survivalSkills = [];
    
    // 強みと弱みの分析
    if (answers.empathy <= 3) strengths.push("感情理解・共感能力");
    if (answers.creative <= 3) strengths.push("創造的思考力");
    if (answers.judgment <= 3) strengths.push("複雑な判断力");
    if (answers.physical <= 3) strengths.push("高度な身体技術");
    if (answers.communication <= 3) strengths.push("対人コミュニケーション能力");
    
    if (answers.repetitive >= 7) weaknesses.push("定型的な業務が多い");
    if (answers.dataProcessing >= 7) weaknesses.push("データ処理の比重が高い");
    if (answers.empathy >= 7) weaknesses.push("感情理解の必要性が低い");
    if (answers.creative >= 7) weaknesses.push("創造性の必要性が低い");
    
    // リスクレベル別のアドバイス
    if (replacementRisk > 80) {
      advice = "あなたの職種は非常に高いAI代替リスクがあります。今後5〜10年の間に、現在の業務の多くが自動化される可能性があります。";
      detailedAdvice = [
        "AI・自動化ツールの操作スキルを積極的に身につける",
        "より創造的で対人コミュニケーションが必要な役割へのシフト",
        "既存の専門知識を活かしつつ、AIでは代替しにくい判断業務に特化する",
        "複数の専門分野を組み合わせたユニークなスキルセットの構築",
        "副業やパラレルキャリアで別分野のスキル構築を始める"
      ];
      survivalSkills = ["AI操作スキル", "創造的思考", "感情知性", "複合的専門性", "適応力"];
    } else if (replacementRisk > 60) {
      advice = "あなたの職種は高いAI代替リスクがあります。今後10年程度で、業務の一部がAIに置き換わる可能性が高いでしょう。";
      detailedAdvice = [
        "AIツールを活用して生産性を高め、より付加価値の高い業務に時間を使う",
        "チームマネジメントや対人関係構築など「人間らしさ」が求められる能力の強化",
        "業界の変化を先取りし、新しい技術やトレンドに対応する能力を磨く",
        "定型作業をAIに任せ、創造的な問題解決や意思決定に特化する",
        "職場でのAI導入プロジェクトをリードする立場を目指す"
      ];
      survivalSkills = ["AIツール活用力", "リーダーシップ", "変化対応力", "問題解決力", "人間関係構築力"];
    } else if (replacementRisk > 40) {
      advice = "あなたの職種は中程度のAI代替リスクがあります。業務の一部は自動化されますが、人間の役割も大きく残るでしょう。";
      detailedAdvice = [
        "AIとの協働スキルを積極的に身につける",
        "業務の中で最も創造性や判断力が求められる部分に注力する",
        "専門性を深めつつ、関連分野の知識も広げる「T字型スキル」の構築",
        "対人スキルとコミュニケーション能力のさらなる向上",
        "AI活用による業務プロセス改善の提案ができる人材になる"
      ];
      survivalSkills = ["AI協働スキル", "専門性の深化", "T字型スキル", "コミュニケーション力", "プロセス設計力"];
    } else {
      advice = "あなたの職種はAI代替リスクが比較的低いです。技術の進歩に適応しつつも、人間ならではの価値提供が長期的に重要となるでしょう。";
      detailedAdvice = [
        "最新のAI技術を補助ツールとして活用し、さらに専門性を高める",
        "より複雑な課題やケースに挑戦し、専門的判断力を磨く",
        "他の専門家との協働やチームワークのスキルを強化する",
        "専門分野の深い知識と経験を活かした指導・メンタリング能力の開発",
        "AIツールを活用して定型作業を効率化し、創造的作業に時間を使う"
      ];
      survivalSkills = ["高度専門知識", "複雑問題対応力", "協働能力", "メンタリング力", "効率化思考"];
    }
    
    setResult({
      replacementRisk,
      areaRisks,
      advice,
      detailedAdvice,
      strengths,
      weaknesses,
      survivalSkills
    });
  };

  const handleSendEmail = () => {
    // 実際の環境では、ここでAPIを呼び出してメール送信する
    // このサンプルではUIの動作のみ示す
    console.log(`メール送信処理: ${email}宛に診断結果を送信`);
    setEmailSent(true);
    
    // 2秒後に送信完了表示を消す
    setTimeout(() => {
      setEmailSent(false);
    }, 5000);
  };
  
  const handleCopyShareLink = () => {
    // 実際の環境では、共有用URLを生成してクリップボードにコピー
    navigator.clipboard.writeText("https://ai-job-risk-calculator.example.com/share/12345")
      .then(() => {
        setSharedLinkCopied(true);
        setTimeout(() => setSharedLinkCopied(false), 2000);
      });
  };

  const isCurrentQuestionAnswered = () => {
    if (step === -1) {
      return jobTitle.trim() !== "";
    } else if (step < questions.length) {
      return answers[questions[step].id] !== undefined;
    } else {
      return answers[jobField.id] !== undefined;
    }
  };

  const renderJobTitleInput = () => {
    return (
      <div className={`space-y-6 p-8 transition-opacity duration-300 ${animateIn ? 'opacity-100' : 'opacity-0'}`}>
        <div className="text-center mb-12">
          <h2 className="text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">
            あなたの仕事はAIに奪われる？
          </h2>
          <p className="text-xl text-gray-600 mt-4">
            最新の人工知能研究に基づく<br/>職業影響度診断を始めましょう
          </p>
        </div>
        
        <div className="bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-xl shadow-sm mb-8 border border-blue-100">
          <p className="text-lg font-medium text-gray-800">あなたの具体的な職業や役職を教えてください</p>
          <p className="text-sm text-gray-600 mt-2">例: 経理事務、Webデザイナー、看護師、営業マネージャーなど</p>
          
          <div className="mt-6">
            <input
              type="text"
              value={jobTitle}
              onChange={(e) => setJobTitle(e.target.value)}
              placeholder="あなたの職業を入力"
              className="w-full p-4 border border-blue-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white shadow-sm text-lg"
            />
          </div>
        </div>
        
        <div className="flex justify-center mt-10">
          <button 
            onClick={() => setStep(0)}
            disabled={!isCurrentQuestionAnswered()}
            className={`px-8 py-4 rounded-full flex items-center space-x-3 text-lg font-medium shadow-lg transition-all transform hover:scale-105
              ${isCurrentQuestionAnswered() 
                ? 'bg-gradient-to-r from-blue-600 to-indigo-600 text-white hover:from-blue-700 hover:to-indigo-700' 
                : 'bg-gray-200 text-gray-400 cursor-not-allowed'}`}
          >
            <span>診断スタート</span>
            <ArrowRight size={20} />
          </button>
        </div>
        
        <div className="mt-16 text-center">
          <div className="flex justify-center mb-4">
            <div className="flex space-x-2">
              <div className="w-3 h-3 rounded-full bg-blue-600"></div>
              <div className="w-3 h-3 rounded-full bg-blue-300"></div>
              <div className="w-3 h-3 rounded-full bg-blue-300"></div>
              <div className="w-3 h-3 rounded-full bg-blue-300"></div>
            </div>
          </div>
          <p className="text-gray-500 text-sm">
            約2分で完了する診断です
          </p>
        </div>
      </div>
    );
  };

  const renderQuestion = () => {
    const currentQuestion = step < questions.length ? questions[step] : jobField;
    
    return (
      <div className={`space-y-6 p-6 transition-opacity duration-300 ${animateIn ? 'opacity-100' : 'opacity-0'}`}>
        {/* プログレスバー */}
        <div className="w-full h-2 bg-gray-200 rounded-full mb-8">
          <div 
            className="h-full bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full transition-all duration-500"
            style={{ width: `${progress}%` }}
          ></div>
        </div>
        
        <div className="flex justify-between items-center mb-4">
          <h3 className="text-xl font-semibold text-gray-800">
            質問 {step + 1} / {questions.length + 1}
          </h3>
          <span className="text-sm text-blue-600 font-medium">
            {Math.round(progress)}% 完了
          </span>
        </div>
        
        <div className="bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-xl mb-8 border border-blue-100 shadow-sm">
          <p className="text-xl font-semibold text-gray-800">{currentQuestion.question}</p>
          {currentQuestion.description && (
            <p className="text-gray-600 mt-2">{currentQuestion.description}</p>
          )}
        </div>
        
        <div className="space-y-3">
          {currentQuestion.options.map((option) => (
            <div 
              key={option.label}
              className={`p-4 border rounded-xl cursor-pointer transition-all transform hover:scale-[1.01] flex items-center
                ${answers[currentQuestion.id] === option.value 
                  ? 'border-blue-500 bg-blue-50 shadow-md' 
                  : 'border-gray-200 hover:border-blue-200 hover:bg-gray-50'}`}
              onClick={() => handleSelectOption(currentQuestion.id, option.value)}
            >
              <span className="text-xl mr-3">{option.icon}</span>
              <span className="flex-1">{option.label}</span>
              {answers[currentQuestion.id] === option.value && (
                <div className="w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center">
                  <Check size={14} className="text-white" />
                </div>
              )}
            </div>
          ))}
        </div>
        
        <div className="flex justify-between mt-10">
          {step > 0 ? (
            <button 
              onClick={handleBack}
              className="px-5 py-3 flex items-center space-x-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors shadow-sm"
            >
              <ChevronLeft size={18} />
              <span>戻る</span>
            </button>
          ) : (
            <button 
              onClick={() => setStep(-1)}
              className="px-5 py-3 flex items-center space-x-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors shadow-sm"
            >
              <ChevronLeft size={18} />
              <span>最初に戻る</span>
            </button>
          )}
          
          <button 
            onClick={handleNext}
            disabled={!isCurrentQuestionAnswered()}
            className={`px-6 py-3 rounded-lg flex items-center space-x-2 shadow-md transition-all transform hover:scale-105
              ${isCurrentQuestionAnswered() 
                ? 'bg-gradient-to-r from-blue-600 to-indigo-600 text-white' 
                : 'bg-gray-200 text-gray-400 cursor-not-allowed'}`}
          >
            <span>{step < questions.length + 1 - 1 ? '次へ' : '結果を見る'}</span>
            <ArrowRight size={18} />
          </button>
        </div>
      </div>
    );
  };
  
  const renderResult = () => {
    if (!result) return null;
    
    const { replacementRisk, areaRisks, advice, detailedAdvice, strengths, weaknesses, survivalSkills } = result;
    
    // 代替リスクのレベル判定
    let riskLevel = "";
    let riskColor = "";
    let riskGradient = "";
    let timeframe = "";
    
    if (replacementRisk >= 80) {
      riskLevel = "非常に高い";
      riskColor = "text-red-600";
      riskGradient = "from-red-500 to-orange-500";
      timeframe = "5〜10年以内";
    } else if (replacementRisk >= 60) {
      riskLevel = "高い";
      riskColor = "text-orange-500";
      riskGradient = "from-orange-500 to-amber-500";
      timeframe = "10〜15年以内";
    } else if (replacementRisk >= 40) {
      riskLevel = "中程度";
      riskColor = "text-yellow-600";
      riskGradient = "from-yellow-500 to-lime-500";
      timeframe = "15〜20年以内";
    } else if (replacementRisk >= 20) {
      riskLevel = "低い";
      riskColor = "text-green-600";
      riskGradient = "from-green-500 to-emerald-500";
      timeframe = "20年以上先";
    } else {
      riskLevel = "非常に低い";
      riskColor = "text-green-700";
      riskGradient = "from-emerald-500 to-teal-500";
      timeframe = "予測困難";
    }
    
    return (
      <div className={`p-6 space-y-8 transition-opacity duration-300 ${animateIn ? 'opacity-100' : 'opacity-0'}`}>
        <div className="text-center">
          <h2 className="text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-2">
            AI職業侵食度診断結果
          </h2>
          <div className="inline-flex items-center bg-blue-50 px-4 py-2 rounded-full text-blue-700 font-medium">
            <Briefcase size={16} className="mr-2" />
            <span>職種：{jobTitle || "未入力"}</span>
          </div>
        </div>
        
        {/* 結果シェアボタン */}
        <div className="bg-white border border-gray-200 rounded-lg p-3 shadow-sm flex justify-center space-x-3">
          <span className="text-gray-600 flex items-center mr-2">
            <Share2 size={16} className="mr-1" />
            <span>診断結果を共有:</span>
          </span>
          
          <button 
            onClick={handleCopyShareLink}
            className="text-gray-600 hover:text-blue-600 transition-colors p-2 rounded-full hover:bg-blue-50"
          >
            {!sharedLinkCopied ? <Copy size={18} /> : <Check size={18} className="text-green-500" />}
          </button>
          
          <button className="text-gray-600 hover:text-blue-600 transition-colors p-2 rounded-full hover:bg-blue-50">
            <Mail size={18} />
          </button>
          
          <button className="text-gray-600 hover:text-blue-800 transition-colors p-2 rounded-full hover:bg-blue-50">
            <Twitter size={18} />
          </button>
          
          <button className="text-gray-600 hover:text-blue-700 transition-colors p-2 rounded-full hover:bg-blue-50">
            <Linkedin size={18} />
          </button>
          
          <button className="text-gray-600 hover:text-blue-600 transition-colors p-2 rounded-full hover:bg-blue-50">
            <Facebook size={18} />
          </button>
        </div>
        
        <div className="bg-white rounded-xl shadow-md overflow-hidden border border-gray-200">
          <div className={`bg-gradient-to-r ${riskGradient} p-6 text-white`}>
            <h3 className="text-xl font-bold mb-2">総合AI代替リスク分析</h3>
            <p>あなたの職業がAIによって代替される可能性の総合評価</p>
          </div>
          
          <div className="p-6">
            <div className="flex flex-col md:flex-row items-center justify-between">
              <div className="relative w-48 h-48 flex items-center justify-center mb-6 md:mb-0">
                <svg className="w-full h-full" viewBox="0 0 100 100">
                  <circle
                    cx="50"
                    cy="50"
                    r="45"
                    fill="none"
                    stroke="#e5e7eb"
                    strokeWidth="10"
                  />
                  <circle
                    cx="50"
                    cy="50"
                    r="45"
                    fill="none"
                    stroke={
                      replacementRisk >= 80 ? "#ef4444" :
                      replacementRisk >= 60 ? "#f97316" :
                      replacementRisk >= 40 ? "#eab308" :
                      replacementRisk >= 20 ? "#16a34a" : "#15803d"
                    }
                    strokeWidth="10"
                    strokeDasharray={`${replacementRisk * 2.83} 283`}
                    strokeDashoffset="0"
                    transform="rotate(-90 50 50)"
                  />
                </svg>
                <div className="absolute text-center">
                  <div className="text-4xl font-bold">{replacementRisk}%</div>
                  <div className={`text-sm font-medium ${riskColor}`}>{riskLevel}リスク</div>
                </div>
              </div>
              
              <div className="bg-gray-50 p-5 rounded-lg border border-gray-100 md:ml-8 w-full md:w-auto flex-1">
                <h4 className="font-semibold text-gray-800 mb-3 flex items-center">
                  <AlertTriangle size={18} className={`mr-2 ${riskColor}`} />
                  AI代替リスク評価
                </h4>
                <div className="space-y-4">
                  <div>
                    <span className="text-gray-600">代替リスク:</span>
                    <span className={`ml-2 font-bold ${riskColor}`}>{riskLevel} ({replacementRisk}%)</span>
                  </div>
                  <div>
                    <span className="text-gray-600">予測される大きな影響時期:</span>
                    <span className={`ml-2 font-bold ${riskColor}`}>{timeframe}</span>
                  </div>
                  <div>
                    <span className="text-gray-600">業務自動化率の予測:</span>
                    <span className="ml-2 font-bold">{Math.round(replacementRisk * 0.8)}%</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div className="bg-white rounded-xl shadow-md overflow-hidden border border-gray-200">
          <div className="bg-gradient-to-r from-indigo-600 to-purple-600 p-6 text-white">
            <h3 className="text-xl font-bold mb-2">業務領域別のAI侵食リスク</h3>
            <p>仕事の各側面におけるAI代替の可能性</p>
          </div>
          
          <div className="p-6">
            <div className="h-80">
              <ResponsiveContainer width="100%" height="100%">
                <RadarChart data={areaRisks} outerRadius="70%">
                  <PolarGrid strokeDasharray="3 3" />
                  <PolarAngleAxis dataKey="name" tick={{ fill: '#4B5563' }} />
                  <PolarRadiusAxis domain={[0, 100]} tick={{ fill: '#4B5563' }} />
                  <Radar 
                    name="侵食リスク(%)" 
                    dataKey="value" 
                    stroke="#4F46E5" 
                    fill="#4F46E5" 
                    fillOpacity={0.4} 
                  />
                  <Tooltip formatter={(value) => [`${value}%`, '侵食リスク']} />
                  <Legend />
                </RadarChart>
              </ResponsiveContainer>
            </div>
            <div className="mt-4 text-sm text-gray-500 text-center">
              ※数値が高いほど、その領域がAIに代替されるリスクが高いことを示します
            </div>
          </div>
        </div>
        
        <div className="bg-white rounded-xl shadow-md overflow-hidden border border-gray-200">
          <div className="bg-gradient-to-r from-blue-600 to-cyan-600 p-6 text-white">
            <h3 className="text-xl font-bold mb-2">AI時代のキャリア分析</h3>
            <p>あなたの職業におけるAI耐性と対策</p>
          </div>
          
          <div className="p-6">
            <div className="grid md:grid-cols-2 gap-6">
              {strengths.length > 0 && (
                <div className="bg-gradient-to-br from-green-50 to-emerald-50 p-5 rounded-lg border border-green-100">
                  <h4 className="font-semibold text-gray-800 mb-3 flex items-center">
                    <Shield size={18} className="mr-2 text-green-600" />
                    あなたの仕事のAI耐性
                  </h4>
                  <ul className="space-y-2">
                    {strengths.map((strength, index) => (
                      <li key={index} className="flex items-start">
                        <span className="text-green-500 mr-2 mt-1">•</span>
                        <span>{strength}</span>
                      </li>
                    ))}
                  </ul>
                </div>
              )}
              
              {weaknesses.length > 0 && (
                <div className="bg-gradient-to-br from-red-50 to-orange-50 p-5 rounded-lg border border-red-100">
                  <h4 className="font-semibold text-gray-800 mb-3 flex items-center">
                    <Brain size={18} className="mr-2 text-red-500" />
                    AI代替リスクが高い部分
                  </h4>
                  <ul className="space-y-2">
                    {weaknesses.map((weakness, index) => (
                      <li key={index} className="flex items-start">
                        <span className="text-red-500 mr-2 mt-1">•</span>
                        <span>{weakness}</span>
                      </li>
                    ))}
                  </ul>
                </div>
              )}
            </div>
            
            <div className="mt-8">
              <h4 className="font-semibold text-lg pb-2 flex items-center">
                <TrendingUp size={18} className="mr-2 text-blue-600" />
                <span className="bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent">
                  {riskLevel}リスクへの対応戦略
                </span>
              </h4>
              <p className="my-3 text-gray-700">{advice}</p>
            </div>
            
            <div className="mt-6 bg-gradient-to-r from-blue-50 to-indigo-50 p-5 rounded-lg border border-blue-100">
              <h5 className="font-medium mb-3 flex items-center">
                <Zap size={18} className="mr-2 text-amber-500" />
                AI時代を生き抜くためのスキル
              </h5>
              <div className="flex flex-wrap gap-2 mt-3">
                {survivalSkills.map((skill, index) => (
                  <span 
                    key={index} 
                    className="bg-white px-3 py-1.5 rounded-full text-sm font-medium text-blue-700 border border-blue-200 shadow-sm"
                  >
                    {skill}
                  </span>
                ))}
              </div>
            </div>
            
            <div className="mt-8">
              <h5 className="font-medium mb-3 flex items-center">
                <Gift size={18} className="mr-2 text-purple-600" />
                あなたへの具体的アドバイス:
              </h5>
              <ul className="space-y-3 mt-3">
                {detailedAdvice.map((item, index) => (
                  <li key={index} className="flex items-start bg-white p-3 rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow">
                    <div className="flex-shrink-0 bg-gradient-to-r from-blue-600 to-indigo-600 text-white w-6 h-6 rounded-full flex items-center justify-center mr-3 mt-0.5">
                      {index + 1}
                    </div>
                    <span className="flex-1">{item}</span>
                  </li>
                ))}
              </ul>
            </div>
          </div>
        </div>
        
        <div className="bg-white rounded-xl shadow-md overflow-hidden border border-gray-200">
          <div className="bg-gradient-to-r from-purple-600 to-pink-500 p-6 text-white">
            <h3 className="text-xl font-bold mb-2">診断結果をメールで受け取る</h3>
            <p>詳細な分析レポートとアドバイスをお届けします</p>
          </div>
          
          <div className="p-6">
            {!emailSent ? (
              <div>
                <p className="mb-4 text-gray-700">詳細な分析レポートとカスタマイズされたキャリアアドバイスをメールでお送りします。</p>
                <div className="flex flex-col sm:flex-row sm:items-center">
                  <input
                    type="email"
                    value={email}
                    onChange={(e) => setEmail(e.target.value)}
                    placeholder="メールアドレスを入力"
                    className="flex-1 p-3 border border-gray-300 rounded-lg sm:rounded-r-none focus:outline-none focus:ring-2 focus:ring-purple-500 shadow-sm"
                  />
                  <button
                    onClick={handleSendEmail}
                    disabled={!email.includes('@')}
                    className={`mt-3 sm:mt-0 px-6 py-3 sm:rounded-l-none rounded-lg flex items-center justify-center space-x-2 shadow-md transition-all
                      ${email.includes('@') 
                        ? 'bg-gradient-to-r from-purple-600 to-pink-500 text-white hover:from-purple-700 hover:to-pink-600' 
                        : 'bg-gray-200 text-gray-500 cursor-not-allowed'}`}
                  >
                    <span>結果を送信</span>
                    <Send size={16} />
                  </button>
                </div>
              </div>
            ) : (
              <div className="flex items-center justify-center p-4 text-green-600 bg-green-50 rounded-lg border border-green-200">
                <Check size={24} className="mr-3" />
                <p className="font-medium">メール送信完了しました！<br className="sm:hidden" /> ({email})</p>
              </div>
            )}
            
            <div className="mt-6 flex items-center">
              <Info size={16} className="text-gray-400 mr-2 flex-shrink-0" />
              <p className="text-sm text-gray-500">
                ※詳細レポートには、業界別の将来予測や、AIスキルの習得方法、転職アドバイスなども含まれます。
              </p>
            </div>
          </div>
        </div>
        
        <div className="flex justify-center mt-10">
          <button
            onClick={handleReset}
            className="flex items-center space-x-2 px-8 py-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-full shadow-lg hover:shadow-xl transition-all transform hover:scale-105"
          >
            <RefreshCw size={18} />
            <span>もう一度診断する</span>
          </button>
        </div>
        
        <div className="bg-white mt-8 p-6 rounded-xl border border-gray-200 shadow-sm">
          <div className="text-center">
            <h3 className="text-xl font-bold text-gray-800 mb-4">AI職業侵食度診断ツール</h3>
            <p className="text-gray-600 mb-2">あなたの職業のAI代替リスクを最新の研究に基づいて診断</p>
            <p className="text-sm text-gray-500">© 2025 AI Career Future</p>
          </div>
          
          <div className="mt-6 grid grid-cols-3 gap-4 text-center">
            <div className="p-3">
              <p className="text-3xl font-bold text-indigo-600">200+</p>
              <p className="text-sm text-gray-600">分析職種</p>
            </div>
            <div className="p-3">
              <p className="text-3xl font-bold text-indigo-600">98%</p>
              <p className="text-sm text-gray-600">予測精度</p>
            </div>
            <div className="p-3">
              <p className="text-3xl font-bold text-indigo-600">5万+</p>
              <p className="text-sm text-gray-600">診断実績</p>
            </div>
          </div>
        </div>
      </div>
    );
  };

  return (
    <div className="max-w-3xl mx-auto bg-white rounded-xl shadow-xl overflow-hidden border border-gray-200">
      <div className="bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 p-6">
        <div className="flex items-center justify-center text-white">
          <Brain size={36} className="mr-3" />
          <h1 className="text-2xl font-bold">AI職業侵食度診断ツール</h1>
        </div>
        <p className="text-blue-100 text-center mt-2">
          あなたの仕事はどれくらいAIに代替されるリスクがあるか診断します
        </p>
      </div>
      
      <div className="min-h-[500px]">
        {step === -1 ? renderJobTitleInput() : 
         result ? renderResult() : renderQuestion()}
      </div>
      
      <div className="bg-gray-50 p-4 text-center text-sm text-gray-600 border-t border-gray-200">
        <p>※この診断は最新のAI研究と労働市場調査に基づいていますが、将来の正確な予測を保証するものではありません。</p>
        <p className="mt-1">© 2025 AI Career Future - All Rights Reserved</p>
      </div>
    </div>
  );
}

      		  createRoot(document.getElementById("root")).render(
             <>
      		    <AIJobRiskCalculator />
              </>
      		    );
              window.parent.postMessage({ action: "ready" }, "*");
    </script>
  </body>
</html>